(function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),define("polyfills",function(){}),define("primitives",["require","exports","module"],function(e,t,n){function a(e){return e*(Math.PI/180)}var r,i,s,o,u;r=function(e,t,n){this.x=e,this.y=t,this.font=n,this.opacity=1,this.color="#333333"},r.prototype.draw=function(e){e.fillStyle=this.color},i=function(e,t,n,r){this.color="rgb(200,0,0)",this.x=e,this.y=t,this.width=n,this.height=r,this.opacity=1},i.prototype.draw=function(e){e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height)},o=function(e,t,n){this.x=e,this.y=t,this.r=n,this.lineWidth="3",this.color="rgb(100,250,250)",this.colorFill="rgb(50, 200, 200)",this.opacity=1},o.prototype.draw=function(e){e.strokeStyle=this.color,e.lineWidth=this.lineWidth,e.fillStyle=this.colorFill,e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI),e.fill(),this.lineWidth>0&&e.stroke(),window.debug!=undefined&&(e.fillStyle="red",e.fillRect(this.x-1,this.y-1,2,2))},u=function(e,t,n,r){this.lineWidth="3",this.color="rgb(150,200,150)",this.x=e,this.y=t,this.x2=n,this.y2=r},u.prototype.draw=function(e){e.strokeStyle=this.color,e.lineWidth=this.lineWidth,e.beginPath(),e.moveTo(this.x,this.y),e.lineTo(this.x2,this.y2),this.lineWidth>0&&e.stroke()},s=function(e,t,n,r){this.colorFill="rgb(200,250,200)",this.lineWidth="3",this.color="rgb(150,200,150)",this.x=e,this.y=t,this.size=n,this.numSides=r,this.rotateAngle=0,this.opacity=1},s.prototype.update=function(){var e=a(360/this.numSides),t=a(this.rotateAngle);this.points=[];for(var n=0;n<this.numSides;n++)this.points[n]={x:this.x+Math.cos(t+e*n)*this.size,y:this.y+Math.sin(t+e*n)*this.size}},s.prototype.draw=function(e){e.strokeStyle=this.color,e.lineWidth=this.lineWidth,e.fillStyle=this.colorFill,e.beginPath();for(var t in this.points)t==0?e.moveTo(this.points[t].x,this.points[t].y):e.lineTo(this.points[t].x,this.points[t].y);e.fill(),this.lineWidth>0&&(e.lineTo(this.points[0].x,this.points[0].y),e.stroke()),window.debug!=undefined&&(e.fillStyle="red",e.fillRect(this.x-1,this.y-1,2,2))},t.Rectangle=i,t.Polygon=s,t.Circle=o,t.Line=u}),define("mouse",["require","exports","module"],function(e,t,n){var r,i,s,o,u;onMouseDownDrag=function(e){this.isDragging=!0},onMoveCheckDragging=function(e,t){this.isDragging&&t.call(this,e)},onMouseUpDrag=function(e){this.isDragging=!1},i=function(e){this.elem=e},s=function(e,t){switch(e){case"click":this.elem.addEventListener("click",t);break;case"move":this.elem.addEventListener("mousemove",t);break;case"drag":onMoveCheckDragging=onMoveCheckDragging.bind(this),u=function(e){onMoveCheckDragging(e,t)},this.elem.addEventListener("mousedown",onMouseDownDrag.bind(this)),this.elem.addEventListener("mousemove",u.bind(this)),this.elem.addEventListener("mouseup",onMouseUpDrag.bind(this));break;case"enter":this.elem.addEventListener("mouseover",t);break;case"leave":this.elem.addEventListener("mouseout",t)}},o=function(e){switch(e){case"click":this.elem.removeEventListener("click",callback);break;case"move":this.elem.removeEventListener("mousemove",callback);break;case"drag":this.elem.removeEventListener("mousedown",onMouseDownDrag),this.elem.removeEventListener("mousemove",u),this.elem.removeEventListener("mouseup",onMouseUpDrag);break;case"enter":this.elem.removeEventListener("mouseover",callback);break;case"leave":this.elem.removeEventListener("mouseout",callback)}},t.init=i,t.on=s,t.off=o}),define("game",["require","exports","module"],function(e,t,n){function r(e,t,n){this.width=t,this.height=n,this.ctx=e,this.assets={},this.states=[],this.state={current:"default",finished:!1},this.backgroundColor="#FAFAFA"}r.prototype.draw=function(){this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.width,this.height);var e=this;this.assets[this.state.current].forEach(function(t){t.opacity>0&&t.draw(e.ctx)})},r.prototype.update=function(){this.assets[this.state.current].forEach(function(e){e.update!=undefined&&e.update()})},r.prototype.addState=function(e,t){t=typeof t!="undefined"?t:!1,this.states.indexOf(e)==-1&&(this.states.push(e),this.assets[e]=[],t&&(this.state.current=e))},r.prototype.checkState=function(){this.state.finished&&this.nextState()},r.prototype.setNextState=function(e){this.state.next=e,this.checkState()},r.prototype.nextState=function(){this.state.old=this.state.current,this.state.current=this.state.next,this.state.next=null,this.state.finished=!1},r.prototype.addItemToState=function(e,t){t=typeof t!="undefined"?t:"default",this.assets[t]===undefined&&(this.assets[t]=[]),this.assets[t].push(e)},r.prototype.loop=function(){this.checkState(),this.update(),this.draw();var e=this;requestAnimationFrame(function(){e.loop()})},t.Game=r}),requirejs.config({baseUrl:"src",paths:{vendor:"../vendor"}}),requirejs(["polyfills","primitives","mouse","game"],function(e,t,n,r){var i=document.getElementById("myCanvas");if(i&&i.getContext){window.context=i.getContext("2d");if(context){var s=new r.Game(context,i.width,i.height);s.addState("Play",!0),s.addState("GameOver");var o=new t.Rectangle(100,100,100,50),u=new t.Rectangle(100,100,100,50);u.color="#00ff00",s.addItemToState(o,"Play"),s.addItemToState(u,"GameOver"),n.init(i),n.on("click",function(){s.setNextState("GameOver"),s.nextState()}),s.loop()}}}),define("main",function(){});